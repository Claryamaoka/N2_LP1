@model AlunoViewModel
@{
    ViewData["Title"] = "Form";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<h1>Cadastro de Alunos</h1>
<hr />

<form action="/Aluno/Salvar" method="post">

    <div asp-validation-summary="All" class="text-danger"></div>
    <input type="hidden" name="Operacao" value="@ViewBag.Operacao" />

    <label for="Id" class="control-label">RA do Aluno</label>
    @if (ViewBag.Operacao == "I")
    {
        <input asp-for="Id" class="form-control" />
        <span asp-validation-for="Id" class="text-danger"></span>
    }
    else
    {
        <input asp-for="Id" readonly class="form-control desabilitado" />
    }

    <br />
    <label for="IdInstrutor" class="control-label">Id do Instrutor</label>
    <input asp-for="IdInstrutor" class="form-control" readonly />

    <br />
    <label for="Nome" class="control-label">Nome do Aluno</label>
    @if (ViewBag.Operacao == "I")
    {
        <input asp-for="Nome" class="form-control" />
        <span asp-validation-for="Nome" class="text-danger"></span>
    }
    else
    {
        <input asp-for="Nome" readonly class="form-control desabilitado" />
    }


    <br />

    <label for="dtNascimento" class="control-label">Data de Nascimento</label>
    @if (ViewBag.Operacao == "I")
    {
        <input asp-for="dtNascimento" class="form-control" type="date" />
        <span asp-validation-for="dtNascimento" class="text-danger"></span>
    }
    else
    {
        <input asp-for="dtNascimento" readonly class="form-control desabilitado" />
    }

    <br />
    <label for="Sexo" class="control-label">Sexo</label>
    @if (ViewBag.Operacao == "I")
    {
        <select asp-for="Sexo" asp-items="@ViewBag.Sexo" class="form-control"></select>
        <span asp-validation-for="Sexo" class="text-danger"></span>
    }
    else
    {
        <select asp-for="Sexo" asp-items="@ViewBag.Sexo" class="form-control"></select>
    }


    <br />
    <label for="Telefone" class="control-label">Telefone para contato</label>
    <input asp-for="Telefone" class="form-control" />
    <span asp-validation-for="Telefone" class="text-danger"></span>

    <br />
    <label for="CEP" class="control-label">CEP</label>
    <input id="CEP" asp-for="CEP" class="form-control" />
    <span asp-validation-for="CEP" class="text-danger"></span>

    <br />
    <label for="Bairro" class="control-label">Bairro</label>
    <input id="Bairro" asp-for="Bairro" class="form-control" />
    <span asp-validation-for="Bairro" class="text-danger"></span>

    <br />
    <label for="Rua" class="control-label">Rua</label>
    <input id="Rua" asp-for="Rua" class="form-control" />
    <span asp-validation-for="Rua" class="text-danger"></span>

    <br />
    <label for="Numero" class="control-label">Número</label>
    <input id="Numero" asp-for="Numero" class="form-control" />
    <span asp-validation-for="Numero" class="text-danger"></span>

    <br />
    <label for="Complemento" class="control-label">Complemento</label>
    <input id="Complemento" asp-for="Complemento" class="form-control" />
    <span asp-validation-for="Complemento" class="text-danger"></span>






    <br />
    <label for="Senha" class="control-label">Senha</label>
    @if (ViewBag.Operacao == "I")
    {
        <input asp-for="Senha" class="form-control" readonly />
    }
    else
    {
        <input asp-for="Senha" class="form-control" />
        <span asp-validation-for="Senha" class="text-danger"></span>
    }

    <div class="form-group">
        <br />
        <input type="file" name="Imagem" id="Imagem" onchange="exibirImagem()" class="btn btn-secondary">
        <img id="imgPreview" src="data:image/jpeg;base64,@Model.ImagemEmBase64" class="img-responsive"
             width="200">
        <span asp-validation-for="Imagem" class="text-danger"></span>
    </div>

    <br />
    <br />
    <input type="submit" value="Salvar dados" class="btn btn-success" />
    &nbsp;&nbsp;&nbsp;&nbsp;
    <a href="/Aluno/Index" class="btn btn-secondary">Voltar</a>


    <br />

    <span class="text-danger">@ViewBag.Erro</span>

</form>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://rawgit.com/RobinHerbots/jquery.inputmask/3.x/dist/jquery.inputmask.bundle.js"></script>
<script type="text/javascript">
    // Método para consultar o CEP
    $('#CEP').on('blur', function () {

        if ($.trim($("#CEP").val()) != "") {


            $.getScript("http://cep.republicavirtual.com.br/web_cep.php?formato=javascript&cep=" + $("#cep").val(), function () {

                if (resultadoCEP["resultado"]) {
                    $("#Rua").val(unescape(resultadoCEP["tipo_logradouro"]) + " " + unescape(resultadoCEP["logradouro"]));
                    $("#Bairro").val(unescape(resultadoCEP["bairro"]));
                    $("#Numero").focus();
                }
            });
        }
    });
</script>
